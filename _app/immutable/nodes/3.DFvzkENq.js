import{f as I,a as M,s as b,e as Z,c as Mt,t as St}from"../chunks/CUg0jjTL.js";import{i as Tt}from"../chunks/tcwNBQes.js";import{o as $t}from"../chunks/DtxHFsW0.js";import{X as It,Y as Pt,p as Lt,g as ct,h as kt,t as q,a as Ft,e as Jt,s as c,c as i,o as z,m as tt,k as a,$ as jt,f as u,r as s,n as ut,j as et}from"../chunks/DM83Yp_6.js";import{i as C}from"../chunks/xBduZJxN.js";import{e as Nt}from"../chunks/DUZWIz6q.js";import{s as Rt,a as Et,c as Gt,t as at}from"../chunks/DeqG99KK.js";import{h as Ut}from"../chunks/B2lhww7r.js";import{s as Dt,a as ft}from"../chunks/DMdtiUjS.js";import{t as Ct}from"../chunks/B8Z0d2C2.js";import{u as B}from"../chunks/AYMUO98B.js";import{c as Ot}from"../chunks/B5JVzsfH.js";class mt{static generateBots(){return[{name:"Magnus FC",rating:2800},{name:"Hikaru Knights",rating:2750},{name:"Nepo Gambit",rating:2700},{name:"Ding United",rating:2650},{name:"Fabi Stars",rating:2600},{name:"Gukesh Generation",rating:2550},{name:"Pragg Power",rating:2500},{name:"Giri Draws",rating:2450},{name:"Levon Artists",rating:2400}].map((e,p)=>({id:`bot-${p}`,name:e.name,isUser:!1,rating:e.rating,played:0,won:0,drawn:0,lost:0,points:0,gf:0,ga:0}))}static simulateMatch(v,e){const p=v-e,_=1/(1+Math.pow(10,(-p-50)/400)),r=Math.random();let f=0,l=0;if(r<_-.15)f=Math.floor(Math.random()*3)+1,l=Math.floor(Math.random()*f);else if(r>_+.15)l=Math.floor(Math.random()*3)+1,f=Math.floor(Math.random()*l);else{const m=Math.floor(Math.random()*3);f=m,l=m}return[Math.max(0,f),Math.max(0,l)]}}const K="gf_league_state",vt={teams:[],fixtures:[],currentMatchday:1,isFinished:!1};function Ht(){const n=localStorage.getItem(K);let v=n?JSON.parse(n):vt;const{subscribe:e,set:p,update:_}=It(v);return{subscribe:e,initLeague:r=>{const f=mt.generateBots(),m=[{id:"user-team",name:r,isUser:!0,rating:1500,played:0,won:0,drawn:0,lost:0,points:0,gf:0,ga:0},...f],d=qt(m),x={teams:m,fixtures:d,currentMatchday:1,isFinished:!1};p(x),localStorage.setItem(K,JSON.stringify(x))},playMatchday:()=>{_(r=>{if(r.currentMatchday>r.fixtures.length)return r;const f=r.fixtures.find(d=>d.id===r.currentMatchday);if(!f)return r;const l=Vt(),m=r.teams.findIndex(d=>d.isUser);return m!==-1&&(r.teams[m].rating=l),f.matches.forEach(d=>{const x=r.teams.find(N=>N.id===d.homeTeamId),H=r.teams.find(N=>N.id===d.awayTeamId),[P,L]=mt.simulateMatch(x.rating,H.rating);d.homeScore=P,d.awayScore=L,d.played=!0,pt(x,P,L),pt(H,L,P)}),r.teams.sort((d,x)=>x.points!==d.points?x.points-d.points:x.gf-x.ga-(d.gf-d.ga)),r.currentMatchday++,r.currentMatchday>r.fixtures.length&&(r.isFinished=!0),localStorage.setItem(K,JSON.stringify(r)),r})},resetLeague:()=>{p(vt),localStorage.removeItem(K)}}}function Vt(){const n=Pt(Ct);if(n.length===0)return 0;const v=n.reduce((e,p)=>e+p.rating,0);return Math.floor(v/n.length)}function pt(n,v,e){n.played++,n.gf+=v,n.ga+=e,v>e?(n.won++,n.points+=3):v===e?(n.drawn++,n.points+=1):n.lost++}function qt(n){const v=n.length-1,e=n.length/2,p=[],_=n.map(r=>r.id);for(let r=0;r<v;r++){const f=[];for(let l=0;l<e;l++){const m=(r+l)%(n.length-1);let d=(n.length-1-l+r)%(n.length-1);l===0&&(d=n.length-1),f.push({homeTeamId:_[m],awayTeamId:_[d],homeScore:0,awayScore:0,played:!1})}p.push({id:r+1,matches:f})}return p}const O=Ht();var zt=I('<button class="btn-primary bg-amber-500 hover:bg-amber-600 border-amber-400">Nueva Temporada</button>'),Bt=I('<span class="ml-2 text-primary text-xs">(TÃº)</span>'),Kt=I('<tr><td class="py-3 font-mono text-slate-400"> </td><td class="py-3 font-bold text-white"> <!></td><td class="py-3 text-center text-slate-300"> </td><td class="py-3 text-center text-slate-400"> </td><td class="py-3 text-center text-slate-400"> </td><td class="py-3 text-center text-slate-400"> </td><td class="py-3 text-center font-mono text-xs text-slate-500"> </td><td class="py-3 text-center font-bold text-white text-base"> </td></tr>'),Yt=I('<div class="text-center py-8"><div class="text-4xl mb-2">ğŸ†</div> <p class="text-white font-bold">Liga Finalizada</p> <p class="text-slate-400 text-sm">Â¡Consulta tu posiciÃ³n final!</p></div>'),At=I('<span class="animate-pulse">Jugando...</span>'),Xt=I('<div class="text-center mb-6"><div class="flex justify-between items-center mb-4"><div class="text-center w-1/3"><div class="w-12 h-12 rounded-full bg-slate-800 border border-white/10 mx-auto mb-2 flex items-center justify-center text-xl font-bold">ğŸ </div> <div class="text-xs font-bold text-white truncate px-1"> </div></div> <div class="font-bold text-slate-500 text-sm">VS</div> <div class="text-center w-1/3"><div class="w-12 h-12 rounded-full bg-slate-800 border border-white/10 mx-auto mb-2 flex items-center justify-center text-xl font-bold">âœˆï¸</div> <div class="text-xs font-bold text-white truncate px-1"> </div></div></div> <button class="w-full btn-primary py-3 font-bold shadow-lg shadow-primary/20 relative group"><!></button></div> <div class="bg-slate-950/50 p-3 rounded text-xs text-center text-slate-400 border border-white/5">Tus puntos se sumarÃ¡n a tu perfil global.</div>',1),Qt=I('<div class="text-center py-4 text-slate-400">Descansas esta jornada</div> <button class="w-full btn-primary py-2 mt-4">Simular Resto de Jornada</button>',1),Wt=I(`<div class="space-y-8"><div class="flex justify-between items-end"><div><h1 class="text-3xl font-bold font-serif text-white mb-2">CompeticiÃ³n Oficial</h1> <p class="text-sm text-slate-400">Juega contra los mejores managers de bots del mundo</p></div> <!></div> <div class="grid grid-cols-1 lg:grid-cols-3 gap-8"><div class="lg:col-span-2 card p-6"><h2 class="text-xl font-bold font-serif text-white mb-4">ClasificaciÃ³n <span class="text-sm font-sans font-normal text-slate-500 ml-2"> </span></h2> <div class="overflow-x-auto"><table class="w-full text-sm"><thead><tr class="text-xs uppercase text-slate-500 border-b border-white/5"><th class="py-3 text-left w-10">#</th><th class="py-3 text-left">Equipo</th><th class="py-3 text-center w-12">PJ</th><th class="py-3 text-center w-12 text-green-400">V</th><th class="py-3 text-center w-12 text-amber-400">E</th><th class="py-3 text-center w-12 text-red-400">D</th><th class="py-3 text-center w-12">DG</th><th class="py-3 text-center w-16 font-bold text-white">PTS</th></tr></thead><tbody class="divide-y divide-white/5"></tbody></table></div></div> <div class="space-y-6"><div class="card p-6 border-primary/30 relative overflow-hidden"><div class="absolute top-0 right-0 w-32 h-32 bg-primary/10 rounded-full blur-3xl -translate-y-1/2 translate-x-1/2"></div> <h3 class="text-white font-bold mb-4 flex items-center gap-2"><span class="text-amber-500">âš¡</span> PrÃ³ximo Partido</h3> <!></div> <div class="bg-blue-500/10 border border-blue-500/20 p-4 rounded-xl"><p class="text-blue-200 text-xs leading-relaxed"><strong>â„¹ï¸ Nota:</strong> La fuerza de tu equipo se basa en la
                    media de Elo de tus 3 titulares. Â¡Ficha mejores jugadores para
                    ganar la liga!</p></div></div></div></div>`);function ue(n,v){Lt(v,!1);const e=()=>ft(O,"$league",_),p=()=>ft(B,"$user",_),[_,r]=Dt(),f=tt(),l=tt();let m=tt(!1);$t(()=>{e().teams.length===0&&O.initLeague(p().username)});function d(){e().isFinished||(z(m,!0),setTimeout(()=>{O.playMatchday(),z(m,!1);const o=e().fixtures.find(h=>h.id===e().currentMatchday-1),t=o==null?void 0:o.matches.find(h=>h.homeTeamId==="user-team"||h.awayTeamId==="user-team");if(t){const h=t.homeTeamId==="user-team",g=h?t.homeScore:t.awayScore,y=h?t.awayScore:t.homeScore;g>y?(at.success(`Â¡Victoria! Ganaste ${g}-${y}`),Ot({particleCount:100,spread:70,origin:{y:.6}}),B.addPoints(10)):g===y?(at.info(`Empate ${g}-${y}`),B.addPoints(3)):(at.error(`Derrota ${g}-${y}`),B.addPoints(-2))}},1500))}function x(o){var t;return((t=e().teams.find(h=>h.id===o))==null?void 0:t.name)||"Unknown"}function H(){confirm("Â¿Reiniciar la liga? PerderÃ¡s el progreso actual.")&&(O.resetLeague(),O.initLeague(p().username))}ct(()=>e(),()=>{z(f,e().fixtures.find(o=>o.id===e().currentMatchday))}),ct(()=>a(f),()=>{var o;z(l,(o=a(f))==null?void 0:o.matches.find(t=>t.homeTeamId==="user-team"||t.awayTeamId==="user-team"))}),kt(),Tt();var P=Wt();Ut("d3rako",o=>{Jt(()=>{jt.title="CompeticiÃ³n - Grandmaster Fantasy"})});var L=i(P),N=c(i(L),2);{var ht=o=>{var t=zt();Z("click",t,H),M(o,t)};C(N,o=>{e(),u(()=>e().isFinished)&&o(ht)})}s(L);var rt=c(L,2),Y=i(rt),A=i(Y),st=c(i(A)),xt=i(st);s(st),s(A);var nt=c(A,2),ot=i(nt),it=c(i(ot));Nt(it,7,()=>(e(),u(()=>e().teams)),o=>o.id,(o,t,h)=>{var g=Kt(),y=i(g),$=i(y,!0);s(y);var S=c(y),k=i(S),R=c(k);{var E=W=>{var wt=Bt();M(W,wt)};C(R,W=>{a(t),u(()=>a(t).isUser)&&W(E)})}s(S);var F=c(S),X=i(F,!0);s(F);var J=c(F),V=i(J,!0);s(J);var G=c(J),j=i(G,!0);s(G);var U=c(G),Q=i(U,!0);s(U);var D=c(U),w=i(D);s(D);var T=c(D),_t=i(T,!0);s(T),s(g),q(()=>{Rt(g,1,`hover:bg-white/5 transition-colors ${a(t),u(()=>a(t).isUser?"bg-primary/10":"")??""}`),b($,a(h)+1),b(k,`${a(t),u(()=>a(t).name)??""} `),b(X,(a(t),u(()=>a(t).played))),b(V,(a(t),u(()=>a(t).won))),b(j,(a(t),u(()=>a(t).drawn))),b(Q,(a(t),u(()=>a(t).lost))),b(w,`${a(t),u(()=>a(t).gf-a(t).ga>0?"+":"")??""}${a(t),u(()=>a(t).gf-a(t).ga)??""}`),b(_t,(a(t),u(()=>a(t).points)))}),Et(1,g,()=>Gt,()=>({y:20,delay:a(h)*50})),M(o,g)}),s(it),s(ot),s(nt),s(Y);var dt=c(Y,2),lt=i(dt),gt=c(i(lt),4);{var bt=o=>{var t=Yt();M(o,t)},yt=o=>{var t=Mt(),h=et(t);{var g=$=>{var S=Xt(),k=et(S),R=i(k),E=i(R),F=c(i(E),2),X=i(F,!0);s(F),s(E);var J=c(E,4),V=c(i(J),2),G=i(V,!0);s(V),s(J),s(R);var j=c(R,2),U=i(j);{var Q=w=>{var T=At();M(w,T)},D=w=>{var T=St();q(()=>b(T,`Jugar Jornada ${e(),u(()=>e().currentMatchday)??""}`)),M(w,T)};C(U,w=>{a(m)?w(Q):w(D,!1)})}s(j),s(k),ut(2),q((w,T)=>{b(X,w),b(G,T),j.disabled=a(m)},[()=>(a(l),u(()=>x(a(l).homeTeamId))),()=>(a(l),u(()=>x(a(l).awayTeamId)))]),Z("click",j,d),M($,S)},y=$=>{var S=Qt(),k=c(et(S),2);Z("click",k,d),M($,S)};C(h,$=>{a(l)?$(g):$(y,!1)},!0)}M(o,t)};C(gt,o=>{e(),u(()=>e().isFinished)?o(bt):o(yt,!1)})}s(lt),ut(2),s(dt),s(rt),s(P),q(()=>b(xt,`Jornada ${e(),u(()=>e().isFinished?e().fixtures.length:e().currentMatchday)??""} / ${e(),u(()=>e().fixtures.length)??""}`)),M(n,P),Ft(),r()}export{ue as component};
